with
    orders as (
        select 
            order_pk
            , creditcard_fk
            , customer_fk
            , shipaddress_fk
            , orderdate
            , order_month
            , order_year
            , subtotal
            , totaldue
            , order_status
        from {{ ref('int_order_header') }}
    )

    , orderheader as (
        select
            order_pk 
            , customer_fk
            , businessentity_fk
            , territory_fk
            , billaddress_fk
            , shipaddress_fk
            , shipmethod_fk
            , creditcard_fk
            , currencyrated_fk
            , revisionnumber 
            , orderdate
            , duedate
            , shipdate
            , status 
            , onlineorderflag 
            , purchaseordernumber 
            , accountnumber 
            , creditcardapprovalcode     
            , subtotal 
            , taxamt 
            , freight 
            , totaldue
            , modifieddate
        from {{ ref('stg_salesorderheader') }}
 )

    , orderdetail as (
        select 
            orderdetail_pk
            , order_fk
            , product_fk
            , orderqty
            , unitprice
            , unitpricediscount
        from {{ ref('stg_salesorderdetail') }}
    )