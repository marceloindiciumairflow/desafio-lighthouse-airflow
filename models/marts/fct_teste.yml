version: 2

models:
  - name: fct_teste
    description: "Fact table consolidating sales data, including deduplicated order details, products, credit cards, and sales reasons."
    columns:
      - name: sales_sk
        description: "Surrogate key generated by hashing order_pk, orderdetail_pk, and product_pk."
        tests:
          - not_null
          - unique

      - name: order_pk
        description: "Primary key for the order."
        tests:
          - not_null

      - name: product_pk
        description: "Primary key for the product."
        tests:
          - not_null

      - name: salesreason_fk
        description: "Foreign key referencing the reason for the sale. Defaults to 0 if no reason is provided."

      - name: orderdetail_pk
        description: "Primary key for the order detail."
        tests:
          - not_null

      - name: subcategory_fk
        description: "Foreign key referencing the product subcategory."

      - name: businessentity_fk
        description: "Foreign key for the employee or business entity. Defaults to 'internet' for online sales."
        tests:
          - not_null

      - name: creditcard_pk
        description: "Primary key for the credit card used in the order."

      - name: customer_fk
        description: "Foreign key referencing the customer placing the order."

      - name: shipaddress_fk
        description: "Foreign key referencing the shipping address for the order."

      - name: orderdate
        description: "Date when the order was placed."

      - name: order_month
        description: "Month extracted from the order date."

      - name: order_year
        description: "Year extracted from the order date."

      - name: subtotal
        description: "Subtotal value of the order before taxes and shipping."

      - name: totaldue
        description: "Total amount due for the order, including taxes and shipping."

      - name: order_status
        description: "Status of the order (e.g., 'In Process', 'Completed'). Defaults to 'no status' if null."

      - name: row_orderdetail
        description: "Row number for the order detail within the order, used for deduplication."

      - name: name_product
        description: "Name of the product."

      - name: productnumber
        description: "Unique number identifying the product."

      - name: standardcost
        description: "Standard cost of the product."

      - name: listprice
        description: "List price of the product."

      - name: productline
        description: "Product line categorization."

      - name: sellstartdate
        description: "Start date for selling the product."

      - name: sellenddate
        description: "End date for selling the product."

      - name: cardtype
        description: "Type of credit card used (e.g., Visa, MasterCard). Defaults to 'no creditcard' if null."

      - name: expiration_date
        description: "Expiration date of the credit card."

      - name: orderqty
        description: "Quantity of the product ordered."

      - name: unitprice
        description: "Unit price of the product."

      - name: unitpricediscount
        description: "Discount applied to the unit price."

      - name: count_items
        description: "Total number of items in the order."

      - name: valor_bruto
        description: "Gross value of the order line item calculated as orderqty * unitprice."

      - name: gross_value
        description: "Total gross value of the order, summing all line items."

      - name: valor_liquido
        description: "Net value of the order line item calculated as orderqty * unitprice * (1 - unitpricediscount)."

      - name: ticket_medio
        description: "Average ticket value per item, calculated as valor_liquido / count_items."
